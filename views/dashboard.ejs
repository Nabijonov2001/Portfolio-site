<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900" rel="stylesheet" />

  <title>Reflux HTML CSS Template</title>
  <!--
Reflux Template
https://templatemo.com/tm-531-reflux
-->
  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Additional CSS Files -->
  <link rel="stylesheet" href="assets/css/fontawesome.css" />
  <link rel="stylesheet" href="assets/css/templatemo-style.css" />
  <link rel="stylesheet" href="assets/css/owl.css" />
  <link rel="stylesheet" href="assets/css/lightbox.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
</head>

<body>
  <div id="page-wraper">
    <!-- Sidebar Menu -->
    <div class="responsive-nav">
      <i class="fa fa-bars" id="menu-toggle"></i>
      <div id="menu" class="menu">
        <i class="fa fa-times" id="menu-close"></i>
        <div class="container">
          <div class="image">
            <a href="/dashboard"><img src="assets/images/<%= user.my_image %> " alt="" /></a>
          </div>
          <div class="author-content">
            <h4>
              <%= user.fullname %>
            </h4>
            <span>
              <%= user.job %>
            </span>
          </div>
          <nav class="main-nav" role="navigation">
            <ul class="main-menu">
              <li><a href="#section1">Mening ma`lumotlarim</a></li>
              <li><a href="#section2">Mening postlarim</a></li>
              <li><a href="#section3">Mening qobilyatlarim</a></li>
              <li><a href="#section4">Mening ishlarim</a></li>
              <li><a href="#section5">Men bilan aloqa</a></li>
              <li><a href="#section6">Izohlar va fikrlar</a></li>
            </ul>
          </nav>
          <div class="social-network">
            <ul class="soial-icons">
              <li>
                <a href="<%= contact.telegram %> "> <h3><i class="bi bi-telegram"></h3></i></a>
              </li>
              <li>
                <a href="<%= contact.github %> "><h3><i class="bi bi-github"></i></h3></a>
              </li>
            </ul>
          </div>
          <div class="copyright-text">
            <p>Copyright 2019 Reflux Design</p>
          </div>
        </div>
      </div>
    </div>

    <section class="section contact-me" data-section="section1">
      <div class="container">
        <div class="section-heading">
          <h2>Mening ma'lumotlarim</h2>
          <div class="line-dec"></div>
          <span>Bu yerga o`zingiz haqingizdagi ma`lumotlarni kiritasiz. Formda ko`rsatilgan ma`lumotlarni
            to`ldiring.</span>
        </div>
        <div class="row">
          <div class="right-content">
            <div class="container">
              <form id="contact" action="/dashboard" method="post" enctype="multipart/form-data">
                <div class="row">
                  <div class="col-md-12">
                    <fieldset style="margin-bottom:1cm;">
                      <label for="image">
                        <img src="assets/images/<%= user.my_image %>" style="width: 170px; height: 170px;"
                          class="rounded-circle">
                      </label>
                      <input style="display: none;" value="image" formenctype="multipart/form-data"
                        src="E:\Html\web ishlanmalar\nodejs\fullstack loyhalar\MyPortfolio\public\assets\images\jpg-4c38cd855533edef3edb7d2b04113b19.jpeg"
                        type="file" id="image" name="image">
                      <h4>Rasmni o`zgartirish</h4>
                    </fieldset>
                  </div>
                  <div class="col-md-6">
                    <fieldset>
                      <input name="name" type="text" class="form-control" id="name" value="<%= user.fullname %> "
                        required="" />
                    </fieldset>
                  </div>
                  <div class="col-md-6">
                    <fieldset>
                      <input name="job" type="text" class="form-control" id="job" value="<%= user.job %> "
                        required="" />
                    </fieldset>
                  </div>

                  <div class="col-md-12">
                    <fieldset>
                      <textarea name="about" rows="6" class="form-control" id="about"
                        required=""><%= user.about_me %> </textarea>
                    </fieldset>
                  </div>
                  <div class="col-md-12">
                    <fieldset>
                      <button type="submit" id="form-submit" class="button">
                        Saqlash
                      </button>
                    </fieldset>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section contact-me" data-section="section2">
      <div class="container">
        <div class="section-heading">
          <h2>Mening postlarim</h2>
          <div class="line-dec"></div>
          <span>Bu yerda siz o`z blogingiz uchun yangi post yozishingiz, avvalgi postlarni esa o`chirishingiz,
            tahrirlashingiz mumkin</span>
        </div>
        <div class="row">
          <div class="right-content">
            <div class="container">
              <form id="contact" action="/dashboard/post" method="post" enctype="multipart/form-data">
                <div class="row">
                  <div class="col-md-12">
                    <fieldset>
                      <h5>Post sarlavhasi</h5>
                      <input name="title" type="text" class="form-control" id="title" required="" />
                    </fieldset>
                  </div>
                  <div class="col-md-12">
                    <fieldset>
                      <h5>Postning qisqacha mazmuni</h5>
                      <textarea name="snippet" rows="6" cols="25" class="form-control" id="snippet"
                        required=""> </textarea>
                    </fieldset>
                  </div>

                  <div class="col-md-12">
                    <fieldset>
                      <h5>Postning matni</h5>
                      <textarea name="main" rows="6" cols="25" class="form-control" id="main" required=""></textarea>
                    </fieldset>
                  </div>
                  <div class="col-md-12">
                    <fieldset>
                      <h5>Post uchun surat</h5>
                      <input type="file" name="image" required id="image">
                    </fieldset>
                  </div>
                  <div class="col-md-12">
                    <fieldset>
                      <button type="submit" id="form-submit" class="button">
                        Saqlash
                      </button>
                    </fieldset>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section my-services" data-section="section3">
      <div class="container">
        <div class="section-heading">
          <h2>Texnologiyalar</h2>
          <div class="line-dec"></div>
          <span>Quydagi texnologiyalarni bilaman.</span>
        </div>
        <div class="row">
          <% skills.forEach(skill=> { %>
            <div class="col-md-6">
              <div class="service-item">
                <input style="margin-bottom: 0.6cm;" id="skill" type="text" value="<%= skill.skill_name %> "> <br>
                <button data-update="<%= skill.id %> " id="save">Save</button> <button data-url="<%= skill.id %> "
                  id="delete">Delete</button>
              </div>
            </div>
            <% }) %>
        </div>
        <button id="add">Qo`shish</button>
    </section>

    <section class="section my-work" data-section="section4">
      <div class="container">
        <div class="section-heading">
          <h2>Mening ishlarim</h2>
          <div class="line-dec"></div>
          <span>Men qilgan proyektlar va loyhalar.</span>
        </div>
        <div class="row">
          <% projects.forEach(project => { %>
            <div class="col-md-4 mb-2">
              <div class="card">
                <div class="card-body pb-5 px-4">
                  <h5 class="card-title text-dark pb-2"><input  style="width: 90%;" type="text" id="project-name" value="<%= project.project_name %> "></h5>
                  <p class="card-text text-secondary">
                     <textarea style="width: 90%;" name="" id="project-about" cols="25" rows="5"><%= project.about %> </textarea> 
                  </p>
                  <input class="mb-3" id="project-link" style="width: 90%; color: blue;" type="text" id="link" value="<%= project.link %> "> <br>
                  <button data-upd="<%= project.id %> " id="project-save" class="btn btn-warning">Save</button> <button data-id="<%= project.id %> " id="project-delete" class="btn btn-danger">Delete</button>
                </div>
              </div>
            </div>
          <% }) %>
				</div>
        <button id="project-add" class="mt-3">Qo`shish</button>
    </section>

    <section class="section my-work" data-section="section5">
      <div class="container">
        <div class="section-heading">
          <h2>Men bilan aloqa</h2>
          <div class="line-dec"></div>
          <span>O`z manzillaringizni kiriting.</span>
        </div>
        <form method="post" action="/dashboard/contact">
          <div class="form-group">
            <label for="exampleInputEmail1">Sizning emailingiz</label>
            <input type="email" class="form-control" id="contact_email" name="contact_email" value="<%= contact.email %> "> 
          </div> 
          <div class="form-group">
            <label for="exampleInputEmail1">Sizning manzilingiz</label>
            <input type="text" class="form-control" id="address" name="address" value="<%= contact.address %> "> 
          </div> 
          <div class="form-group">
            <label for="exampleInputEmail1">Telefon raqamingiz</label>
            <input type="text" class="form-control" id="phone_number" name="phone_number" value="<%= contact.phone_number%>"> 
          </div> 
          <div class="form-group">
            <label for="exampleInputEmail1">Telegram linkingiz</label>
            <input type="text" class="form-control" id="telegram" name="telegram" value="<%= contact.telegram%>"> 
          </div> 
          <div class="form-group">
            <label for="exampleInputEmail1">Github linkingiz</label>
            <input type="text" class="form-control" id="github" name="github" value="<%= contact.github%>"> 
          </div> 
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </section>

    
    <section class="section my-work" data-section="section6">
      <div class="container">
        <div class="section-heading">
          <h2>Izohlar va fikrlar</h2>
          <div class="line-dec"></div>
          <span>Sayt foydalanuvchilaridan kelgan xabarlar.</span>
        </div>
        <div class="row">
				</div>
        <% comments.forEach(comment => { %>
          
        <div class="typo">
          <span class="typo-note text-warning">Izohlar va fikrlar:</span>
          <div class="blockquote">
            <p><%= comment.msg_text %> </p>
            <small class="text-info">
              &mdash; <%= comment.fullname %>   
            </small>
          </div>
        </div>
        
        <% }) %>
    </section>
  </div>

  <script>

    // skills
    const add_btn = document.querySelector('#add')
    add_btn.addEventListener('click', async (e) => {
      let data = new FormData()
      data.append('skill', 'Texnologiya')
      const response = await fetch(`/dashboard/skill`, {
        method: "Post",
        body: data
      })
      window.location.reload('/dashboard')


    })

    const del_btn = document.querySelectorAll('#delete')
    del_btn.forEach(btn => {
      btn.addEventListener('click', async () => {
        await fetch(`/dashboard/skill/${btn.dataset.url}`, {
          method: 'DELETE'
        })
        window.location.reload('/dashboard')
      })
    })

    const save_btn = document.querySelectorAll('#save')
    const skill_input = document.querySelectorAll('#skill')
    save_btn.forEach((btn, index)=>{
        btn.addEventListener('click', async () => {
          const data = new FormData()
          data.append('skill', skill_input[index].value)
          await fetch(`/dashboard/skill/${btn.dataset.update}`, {
            method: 'Put',
            body: data
          })
          window.location.reload('/dashboard')
      })
    })
  
    // projects
    const projectAddBtn = document.querySelector('#project-add')
    projectAddBtn.addEventListener('click', async (e) => {
      console.log(projectAddBtn)
      let data = new FormData()
      data.append('title', 'Card title treatment')
      data.append('about', 'With supporting text below as a natural lead-in to additional content. A small river named  the necessary regelialia.')
      data.append('link', 'https://github.com')
      const response = await fetch(`/dashboard/project`, {
        method: "Post",
        body: data
      })
      window.location.reload('/dashboard')


    })
    
    const deleteProjectBtn = document.querySelectorAll('#project-delete')
    deleteProjectBtn.forEach(btn=>{
      btn.addEventListener('click', async () => {
        console.log(btn)
        await fetch(`/dashboard/project/${btn.dataset.id}`, {
          method: 'DELETE'
        })
        window.location.reload('/dashboard')
      })
    })
  
    const saveProjectBtn = document.querySelectorAll('#project-save')
    const project_title = document.querySelectorAll('#project-name')
    const project_about  = document.querySelectorAll('#project-about')
    const project_link = document.querySelectorAll('#project-link')
    saveProjectBtn.forEach((btn, index)=>{
        btn.addEventListener('click', async () => {
          console.log(project_title[index].value)
          const data = new FormData()
          data.append('project_name', project_title[index].value)
          data.append('project_about', project_about[index].value)
          data.append('project_link', project_link[index].value)
          await fetch(`/dashboard/project/${btn.dataset.upd}`, {
            method: 'Put',
            body: data
          })
          window.location.reload('/dashboard')
      })
    })
  </script>
  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/lightbox.js"></script>
  <script src="assets/js/custom.js"></script>
  <script>
    //according to loftblog tut
    $(".main-menu li:first").addClass("active");

    var showSection = function showSection(section, isAnimate) {
      var direction = section.replace(/#/, ""),
        reqSection = $(".section").filter(
          '[data-section="' + direction + '"]'
        ),
        reqSectionPos = reqSection.offset().top - 0;

      if (isAnimate) {
        $("body, html").animate(
          {
            scrollTop: reqSectionPos
          },
          800
        );
      } else {
        $("body, html").scrollTop(reqSectionPos);
      }
    };

    var checkSection = function checkSection() {
      $(".section").each(function () {
        var $this = $(this),
          topEdge = $this.offset().top - 80,
          bottomEdge = topEdge + $this.height(),
          wScroll = $(window).scrollTop();
        if (topEdge < wScroll && bottomEdge > wScroll) {
          var currentId = $this.data("section"),
            reqLink = $("a").filter("[href*=\\#" + currentId + "]");
          reqLink
            .closest("li")
            .addClass("active")
            .siblings()
            .removeClass("active");
        }
      });
    };

    $(".main-menu").on("click", "a", function (e) {
      e.preventDefault();
      showSection($(this).attr("href"), true);
    });

    $(window).scroll(function () {
      checkSection();
    });
  
  </script>

</body>

</html>